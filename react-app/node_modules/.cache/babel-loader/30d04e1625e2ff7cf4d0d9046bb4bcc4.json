{"ast":null,"code":"import _objectSpread from\"/home/brandon/Desktop/Research/Modern_Task_WAPP/react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"/home/brandon/Desktop/Research/Modern_Task_WAPP/react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/home/brandon/Desktop/Research/Modern_Task_WAPP/react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState,useReducer}from'react';import{Helmet}from\"react-helmet\";import{Label,Table,Segment,Modal,Header,Form,TextArea,Dropdown,Button,Icon,Divider,Checkbox,Search,Grid,Message}from'semantic-ui-react';import _ from'lodash';import'semantic-ui-css/semantic.min.css';import'./App.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var backend_uri=\"/api/\";;var statuses=[{key:\"Not Started\",text:\"Not Started\",value:\"Not Started\"},{key:\"In Progress\",text:\"In Progress\",value:\"In Progress\"},{key:\"Completed\",text:\"Completed\",value:\"Completed\"}];var TagDropDown=function TagDropDown(props){var initOptions=[];props.tagSet.forEach(function(tag){initOptions.push({key:tag,text:tag,value:tag});});var _useState=useState(initOptions),_useState2=_slicedToArray(_useState,2),options=_useState2[0],setOptions=_useState2[1];var handleAddition=function handleAddition(e,_ref){var value=_ref.value;setOptions([{key:value,text:value,value:value}].concat(_toConsumableArray(options)));};var handleChange=function handleChange(e,_ref2){var value=_ref2.value;props.onChange(value);};return/*#__PURE__*/_jsx(Dropdown,{options:options,value:props.currentTags,placeholder:\"Select Tag\",search:true,selection:true,fluid:true,multiple:true,allowAdditions:true,onAddItem:handleAddition,onChange:handleChange});};var TaskRow=function TaskRow(props){var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),open=_useState4[0],setOpen=_useState4[1];var _useState5=useState(props.taskInfo.name),_useState6=_slicedToArray(_useState5,2),taskName=_useState6[0],setTaskName=_useState6[1];var _useState7=useState(props.taskInfo.desc),_useState8=_slicedToArray(_useState7,2),taskDesc=_useState8[0],setTaskDesc=_useState8[1];var _useState9=useState(props.taskInfo.tags),_useState10=_slicedToArray(_useState9,2),tags=_useState10[0],setTags=_useState10[1];var _useState11=useState(props.taskInfo.taskStatus),_useState12=_slicedToArray(_useState11,2),taskStatus=_useState12[0],setTaskStatus=_useState12[1];var handleTagsChange=function handleTagsChange(tags){setTags(tags);};var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),isError=_useState14[0],setIsError=_useState14[1];var trigger_element=!props.isCreate?/*#__PURE__*/_jsxs(Table.Row,{children:[/*#__PURE__*/_jsx(Table.Cell,{children:props.taskInfo.name}),/*#__PURE__*/_jsx(Table.Cell,{children:props.taskInfo.desc}),/*#__PURE__*/_jsx(Table.Cell,{children:/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",flexWrap:\"wrap\"},children:props.taskInfo.tags.map(function(tag){return/*#__PURE__*/_jsx(\"div\",{style:{padding:2},children:/*#__PURE__*/_jsx(Label,{color:\"blue\",tag:true,children:tag})});})})}),/*#__PURE__*/_jsx(Table.Cell,{children:props.taskInfo.taskStatus==='Not Started'?/*#__PURE__*/_jsx(Label,{color:\"red\",children:props.taskInfo.taskStatus}):props.taskInfo.taskStatus==='In Progress'?/*#__PURE__*/_jsx(Label,{color:\"orange\",children:props.taskInfo.taskStatus}):/*#__PURE__*/_jsx(Label,{color:\"green\",children:props.taskInfo.taskStatus})})]},props.taskInfo._id):/*#__PURE__*/_jsxs(Button,{icon:true,size:\"huge\",labelPosition:\"left\",children:[/*#__PURE__*/_jsx(Icon,{name:\"plus circle\"}),\"Add\"]});var modalHeader=props.isCreate?\"Add New Task\":\"Edit Task\";var modalContentHeader=props.isCreate?null:/*#__PURE__*/_jsxs(Header,{children:[\"Editing Task: \",props.taskInfo.name]});var modalActions=props.isCreate?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{onClick:function onClick(){setOpen(false);setTaskName(props.taskInfo.name);setTaskDesc(props.taskInfo.desc);setTags(props.taskInfo.tags);setTaskStatus(props.taskInfo.taskStatus);},children:\"Cancel\"}),/*#__PURE__*/_jsxs(Button,{color:\"green\",onClick:function onClick(){if(taskName===\"\"){setIsError(true);return;}setIsError(false);console.log(\"Adding Task\",taskName);fetch(backend_uri+\"createtask\",{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({name:taskName,desc:taskDesc,tags:tags,taskStatus:taskStatus})}).then(function(res){if(res.ok){console.log(\"Task Added\");setOpen(false);props.refreshCallback();// Reset the form\nsetTaskName(props.taskInfo.name);setTaskDesc(props.taskInfo.desc);setTags(props.taskInfo.tags);setTaskStatus(props.taskInfo.taskStatus);}else{console.log(\"Task Addition Failed\");}});},children:[/*#__PURE__*/_jsx(Icon,{name:\"checkmark\"}),\" Save\"]})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button.Group,{floated:\"left\",children:/*#__PURE__*/_jsx(Button,{negative:true,onClick:function onClick(){console.log(\"Deleting Task\",taskName);fetch(backend_uri+\"deletetask\",{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({_id:props.taskInfo._id})}).then(function(res){if(res.ok){console.log(\"Task Deleted\");setOpen(false);props.refreshCallback();}else{console.log(\"Task Delete Failed\");}});},children:\"Delete Task\"})}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){setOpen(false);setTaskName(props.taskInfo.name);setTaskDesc(props.taskInfo.desc);setTags(props.taskInfo.tags);setTaskStatus(props.taskInfo.taskStatus);},children:\"Cancel\"}),/*#__PURE__*/_jsxs(Button,{color:\"green\",onClick:function onClick(){if(taskName===\"\"){setIsError(true);return;}setIsError(false);console.log(\"Updating Task\",taskStatus);fetch(backend_uri+\"updatetask\",{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({_id:props.taskInfo._id,name:taskName,desc:taskDesc,tags:tags,taskStatus:taskStatus})}).then(function(res){if(res.ok){console.log(\"Task Updated\");setOpen(false);props.refreshCallback();}else{console.log(\"Task Update Failed\");}});},children:[/*#__PURE__*/_jsx(Icon,{name:\"checkmark\"}),\" Save\"]})]});return/*#__PURE__*/_jsxs(Modal,{onClose:function onClose(){return setOpen(false);},onOpen:function onOpen(){return setOpen(true);},open:open,closeOnDimmerClick:false,closeOnEscape:false,trigger:trigger_element,children:[/*#__PURE__*/_jsx(Modal.Header,{children:modalHeader}),/*#__PURE__*/_jsx(Modal.Content,{children:/*#__PURE__*/_jsxs(Modal.Description,{children:[modalContentHeader,/*#__PURE__*/_jsxs(Form,{error:isError,children:[/*#__PURE__*/_jsxs(Form.Field,{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Task Name\"}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"Task Name\",defaultValue:taskName,onChange:function onChange(e){return setTaskName(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Field,{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Task Description\"}),/*#__PURE__*/_jsx(TextArea,{placeholder:\"Task Description\",defaultValue:taskDesc,onChange:function onChange(e){return setTaskDesc(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Field,{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Tags\"}),/*#__PURE__*/_jsx(TagDropDown,{tagSet:props.tagSet,currentTags:tags,onChange:handleTagsChange})]}),/*#__PURE__*/_jsxs(Form.Field,{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Task Status\"}),/*#__PURE__*/_jsx(Dropdown,{placeholder:\"Select Status\",fluid:true,selection:true,options:statuses,defaultValue:taskStatus,onChange:function onChange(e,_ref3){var value=_ref3.value;setTaskStatus(value);}})]}),/*#__PURE__*/_jsx(Message,{error:true,header:\"Error\",content:\"Ensure the task name is not empty!\"})]})]})}),/*#__PURE__*/_jsx(Modal.Actions,{children:modalActions})]});};TaskRow.defaultProps={isCreate:false,taskInfo:{_id:\"\",name:\"\",desc:\"\",tags:[],taskStatus:\"Not Started\"}};function SearchBox(props){var initialState={loading:false,results:[],value:''};function SearchBoxReducer(state,action){switch(action.type){case'CLEAN_QUERY':return initialState;case'START_SEARCH':return _objectSpread(_objectSpread({},state),{},{loading:true,value:action.query});case'FINISH_SEARCH':return _objectSpread(_objectSpread({},state),{},{loading:false,results:action.results});case'UPDATE_SELECTION':return _objectSpread(_objectSpread({},state),{},{value:action.selection});default:throw new Error();}}var _useReducer=useReducer(SearchBoxReducer,initialState),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];var loading=state.loading,results=state.results,value=state.value;// Update results while typing\nvar timeoutRef=React.useRef(0);var handleSearchChange=React.useCallback(function(e,data){clearTimeout(timeoutRef.current);dispatch({type:'START_SEARCH',query:data.value});timeoutRef.current=window.setTimeout(function(){if(data.value.length===0){dispatch({type:'CLEAN_QUERY'});return;}var re=new RegExp(_.escapeRegExp(data.value),'i');var isMatch=!props.searchInDesc?function(result){return re.test(result.title);}:function(result){return re.test(result.title)||re.test(result.description);};dispatch({type:'FINISH_SEARCH',results:_.filter(props.source,isMatch)});},300);},[props.source,props.searchInDesc]);useEffect(function(){dispatch({type:'FINISH_SEARCH',results:props.source});return function(){clearTimeout(timeoutRef.current);};},[props.source]);useEffect(function(){props.updateValue(value);},[value,props]);return/*#__PURE__*/_jsx(Search,{fluid:true,size:\"large\",loading:loading,placeholder:\"Search...\",onResultSelect:function onResultSelect(e,data){dispatch({type:'UPDATE_SELECTION',selection:data.result.title});},onSearchChange:handleSearchChange,results:results,value:value});}var TaskTable=function TaskTable(){var _useState15=useState(new Array()),_useState16=_slicedToArray(_useState15,2),tagSet=_useState16[0],setTagSet=_useState16[1];// Main Table States: Sorting Column, Table Data, Sorting Direction\nfunction sortReducer(state,action){switch(action.type){case'RESET':return initTable(action.payload);case'CHANGE_SORT':if(state.column===action.column){return _objectSpread(_objectSpread({},state),{},{data:state.data.slice().reverse(),direction:state.direction==='ascending'?'descending':'ascending'});}return{column:action.column,data:_.sortBy(state.data,[action.column]),direction:'ascending'};default:throw new Error();}}var initTable=function initTable(newdata){return{column:null,data:newdata,direction:null};};var _useState17=useState(new Array()),_useState18=_slicedToArray(_useState17,2),backupData=_useState18[0],setBackupData=_useState18[1];var _useReducer3=useReducer(sortReducer,[],initTable),_useReducer4=_slicedToArray(_useReducer3,2),state=_useReducer4[0],dispatch=_useReducer4[1];// here state = {column, data, dir}\nvar column=state.column,data=state.data,direction=state.direction;// Searching States\nvar _useState19=useState([]),_useState20=_slicedToArray(_useState19,2),searchData=_useState20[0],setSearchData=_useState20[1];var _useState21=useState([]),_useState22=_slicedToArray(_useState21,2),searchTagOptions=_useState22[0],setSearchTagOptions=_useState22[1];var _useState23=useState(\"\"),_useState24=_slicedToArray(_useState23,2),searchField=_useState24[0],setSearchField=_useState24[1];var _useState25=useState(false),_useState26=_slicedToArray(_useState25,2),searchInDesc=_useState26[0],setSearchInDesc=_useState26[1];var _useState27=useState([]),_useState28=_slicedToArray(_useState27,2),searchTags=_useState28[0],setSearchTags=_useState28[1];var _useState29=useState(\"\"),_useState30=_slicedToArray(_useState29,2),searchStatus=_useState30[0],setSearchStatus=_useState30[1];// Initial Set-Up, to replace with backend query\nvar initialiseData=function initialiseData(){/*\n    let initTasks: Array<taskRowRep> = [\n      { _id: \"1\", name: 'Learn HTML', desc: \"Create at least something\", tags: ['Task 1.1', 'Task 1.2', \"Brandon\", \"Hello\", \"hello\"], taskStatus: \"Not Started\" },\n      { _id: \"2\", name: 'Learn CSS', desc: \"Create at least a stylesheet\", tags: ['Task 2.1', 'Task 2.2'], taskStatus: \"In Progress\" },\n      { _id: \"3\", name: 'Learn JAVASCRIPT', desc: \"Create at least an APP\", tags: ['Task 3.1', 'Task 3.2'], taskStatus: \"Completed\" },\n      { _id: \"4\", name: 'Learn C++', desc: \"Create at least a programme\", tags: ['Task 3.1', 'Task 3.2'], taskStatus: \"Completed\" },\n      { _id: \"5\", name: 'Learn Python', desc: \"Create at least an AI\", tags: ['Task 3.1', 'Task 3.2'], taskStatus: \"Completed\" },\n      { _id: \"6\", name: 'Learn Haskell', desc: \"Create at least a paper\", tags: ['Task 3.1', 'Task 3.2'], taskStatus: \"Completed\" },\n      { _id: \"7\", name: 'Learn C#', desc: \"Create at least an game\", tags: ['Task 3.1', 'Task 3.2'], taskStatus: \"Completed\" },\n    ];*/var requestOptions={method:'POST',headers:{'Content-Type':'application/json'}};fetch(backend_uri+\"getdata\",requestOptions).then(function(response){return response.json();}).then(function(initTasks){console.log(\"initTasks: \",initTasks);// Initialise States\ndispatch({type:'RESET',payload:initTasks});setBackupData(initTasks);// Convert to SearchBox format {index, title, description, tags, taskStatus}\nvar initSearchData=initTasks.map(function(task){return{_id:task._id,title:task.name,description:task.desc,tags:task.tags,taskStatus:task.taskStatus};});setSearchData(initSearchData);var initTagSet=new Array();initTasks.forEach(function(task){task.tags.forEach(function(tag){initTagSet.push(tag);});});initTagSet=Array.from(new Set(initTagSet));// Remove duplicates\ninitTagSet.sort(function(a,b){// Sort alphabetically\nreturn a.toLowerCase()>b.toLowerCase()?1:-1;});// Convert to Search Tag Dropdown Format {key, text, value}\nvar initsearchTagOptions=new Array();initTagSet.forEach(function(tag){initsearchTagOptions.push({key:tag,text:tag,value:tag});});setSearchTagOptions(initsearchTagOptions);setTagSet(initTagSet);}).catch(function(error){return console.log('Error Getting Data from Server: ',error);});};useEffect(initialiseData,[]);// ===== Handle Searching =====\n// Update Filters\nuseEffect(function(){var newSearchOptions=backupData.map(function(task){return{_id:task._id,title:task.name,description:task.desc,tags:task.tags,taskStatus:task.taskStatus};});if(searchTags.length>0){newSearchOptions=newSearchOptions.filter(function(task){return searchTags.every(function(tag){return task.tags.includes(tag);});});}if(searchStatus!==\"\"){newSearchOptions=newSearchOptions.filter(function(task){return task.taskStatus===searchStatus;});}setSearchData(newSearchOptions);},[searchTags,searchStatus,backupData]);var handleSubmit=function handleSubmit(){var newData=backupData;if(searchField!==\"\"){newData=newData.filter(function(task){if(searchInDesc){return task.desc.toLowerCase().includes(searchField.toLowerCase())||task.name.toLowerCase().includes(searchField.toLowerCase());}else{return task.name.toLowerCase().includes(searchField.toLowerCase());}});}if(searchTags.length>0){newData=newData.filter(function(task){return searchTags.every(function(tag){return task.tags.includes(tag);});});}if(searchStatus!==\"\"){newData=newData.filter(function(task){return task.taskStatus===searchStatus;});}dispatch({type:'RESET',payload:newData});};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Grid,{stackable:true,children:/*#__PURE__*/_jsxs(Grid.Row,{stretched:true,children:[/*#__PURE__*/_jsx(Grid.Column,{width:14,children:/*#__PURE__*/_jsx(Segment,{children:/*#__PURE__*/_jsx(Form,{onSubmit:handleSubmit,children:/*#__PURE__*/_jsxs(Form.Group,{inline:true,children:[/*#__PURE__*/_jsx(\"label\",{children:\"Search\"}),/*#__PURE__*/_jsx(\"div\",{style:{width:\"40em\"},children:/*#__PURE__*/_jsx(SearchBox,{source:searchData,searchInDesc:searchInDesc,updateValue:setSearchField},JSON.stringify(searchData)+searchInDesc)}),/*#__PURE__*/_jsx(\"div\",{children:\"\\xA0\\xA0\"}),/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",alignItems:\"center\"},children:/*#__PURE__*/_jsx(Form.Field,{children:/*#__PURE__*/_jsx(Checkbox,{label:\"Search in Descriptions\",onChange:function onChange(e,d){setSearchInDesc(d.checked);}})})}),/*#__PURE__*/_jsx(\"label\",{children:\"Filters\"}),/*#__PURE__*/_jsx(Dropdown,{placeholder:\"Select Tags\",fluid:true,multiple:true,search:true,selection:true,onChange:function onChange(e,_ref4){var value=_ref4.value;setSearchTags(value);},options:searchTagOptions}),/*#__PURE__*/_jsx(\"div\",{children:\"\\xA0\\xA0\"}),/*#__PURE__*/_jsx(Dropdown,{placeholder:\"Select Status\",clearable:true,selection:true,options:statuses,onChange:function onChange(e,_ref5){var value=_ref5.value;setSearchStatus(value);}}),/*#__PURE__*/_jsx(\"div\",{children:\"\\xA0\\xA0\"}),/*#__PURE__*/_jsx(Form.Button,{content:\"Submit\"})]})})})}),/*#__PURE__*/_jsx(Grid.Column,{width:2,children:/*#__PURE__*/_jsxs(Segment,{style:{display:\"flex\",justifyContent:\"center\",alignItems:\"center\"},children:[\"\\xA0\\xA0\",/*#__PURE__*/_jsx(TaskRow,{tagSet:tagSet,refreshCallback:initialiseData,isCreate:true})]})})]})}),/*#__PURE__*/_jsxs(Table,{celled:true,selectable:true,sortable:true,children:[/*#__PURE__*/_jsx(Table.Header,{children:/*#__PURE__*/_jsxs(Table.Row,{children:[/*#__PURE__*/_jsx(Table.HeaderCell,{sorted:column==='name'?direction:null,onClick:function onClick(){dispatch({type:'CHANGE_SORT',column:'name'});},width:3,children:\"Task Name\"},\"name\"),/*#__PURE__*/_jsx(Table.HeaderCell,{sorted:column==='desc'?direction:null,onClick:function onClick(){return dispatch({type:'CHANGE_SORT',column:'desc'});},width:7,children:\"Task Description\"},\"desc\"),/*#__PURE__*/_jsx(Table.HeaderCell,{sorted:column==='tags'?direction:null,onClick:function onClick(){return dispatch({type:'CHANGE_SORT',column:'tags'});},width:4,children:\"Tags\"},\"tags\"),/*#__PURE__*/_jsx(Table.HeaderCell,{sorted:column==='taskStatus'?direction:null,onClick:function onClick(){return dispatch({type:'CHANGE_SORT',column:'taskStatus'});},width:2,children:\"Completed\"},\"taskStatus\")]})}),/*#__PURE__*/_jsx(Table.Body,{children:data.map(function(rowData){return/*#__PURE__*/_jsx(TaskRow,{taskInfo:rowData,tagSet:tagSet,refreshCallback:initialiseData},rowData._id);})})]})]});};var MainBodySegment=function MainBodySegment(){return/*#__PURE__*/_jsx(\"div\",{className:\"mainBodySegment\",children:/*#__PURE__*/_jsxs(Segment,{children:[/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center'},children:/*#__PURE__*/_jsx(\"h1\",{children:\"Brandon's \\\"Modern\\\" To-Do App\"})}),/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsx(TaskTable,{})]})});};function App(){useEffect(function(){document.title=\"Modern TODO App\";});return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'3em'},children:[/*#__PURE__*/_jsx(Helmet,{children:/*#__PURE__*/_jsx(\"style\",{children:\"body { background-color: #eddefa; }\"})}),/*#__PURE__*/_jsx(MainBodySegment,{})]});}export default App;","map":{"version":3,"names":["React","useEffect","useState","useReducer","Helmet","Label","Table","Segment","Modal","Header","Form","TextArea","Dropdown","Button","Icon","Divider","Checkbox","Search","Grid","Message","_","backend_uri","statuses","key","text","value","TagDropDown","props","initOptions","tagSet","forEach","tag","push","options","setOptions","handleAddition","e","handleChange","onChange","currentTags","TaskRow","open","setOpen","taskInfo","name","taskName","setTaskName","desc","taskDesc","setTaskDesc","tags","setTags","taskStatus","setTaskStatus","handleTagsChange","isError","setIsError","trigger_element","isCreate","display","flexWrap","map","padding","_id","modalHeader","modalContentHeader","modalActions","console","log","fetch","method","headers","body","JSON","stringify","then","res","ok","refreshCallback","target","defaultProps","SearchBox","initialState","loading","results","SearchBoxReducer","state","action","type","query","selection","Error","dispatch","timeoutRef","useRef","handleSearchChange","useCallback","data","clearTimeout","current","window","setTimeout","length","re","RegExp","escapeRegExp","isMatch","searchInDesc","result","test","title","description","filter","source","updateValue","TaskTable","Array","setTagSet","sortReducer","initTable","payload","column","slice","reverse","direction","sortBy","newdata","backupData","setBackupData","searchData","setSearchData","searchTagOptions","setSearchTagOptions","searchField","setSearchField","setSearchInDesc","searchTags","setSearchTags","searchStatus","setSearchStatus","initialiseData","requestOptions","response","json","initTasks","initSearchData","task","initTagSet","from","Set","sort","a","b","toLowerCase","initsearchTagOptions","catch","error","newSearchOptions","every","includes","handleSubmit","newData","width","alignItems","d","checked","justifyContent","rowData","MainBodySegment","textAlign","App","document"],"sources":["/home/brandon/Desktop/Research/Modern_Task_WAPP/react-app/src/App.tsx"],"sourcesContent":["import React, { useEffect, useState, useReducer } from 'react';\nimport { Helmet } from \"react-helmet\";\nimport { Label, Table, Segment, Modal, Header, Form, TextArea, Dropdown, Button, Icon, Divider, Checkbox, Search, Grid, Message } from 'semantic-ui-react';\nimport _ from 'lodash';\nimport 'semantic-ui-css/semantic.min.css'\nimport './App.css';\n\nconst backend_uri = \"/api/\";\n\ninterface searchBoxRep { _id: string, title: string, description: string, tags: Array<string>, taskStatus: string };\ninterface taskRowRep { _id: string, name: string, desc: string, tags: Array<string>, taskStatus: string }\nconst statuses = [{ key: \"Not Started\", text: \"Not Started\", value: \"Not Started\" },\n{ key: \"In Progress\", text: \"In Progress\", value: \"In Progress\" },\n{ key: \"Completed\", text: \"Completed\", value: \"Completed\" }];\n\nconst TagDropDown = (props: { tagSet: Array<string>, onChange: any, currentTags: Array<string> }) => {\n  let initOptions: Array<{ key: string, text: string, value: string }> = [];\n  props.tagSet.forEach(tag => {\n    initOptions.push({ key: tag, text: tag, value: tag });\n  });\n\n  const [options, setOptions] = useState(initOptions);\n\n  const handleAddition = (e: {}, { value }: any) => {\n    setOptions([{ key: value, text: value, value: value }, ...options]);\n  }\n  const handleChange = (e: {}, { value }: any) => { props.onChange(value); }\n  return (\n    <Dropdown\n      options={options}\n      value={props.currentTags}\n      placeholder='Select Tag'\n      search\n      selection\n      fluid\n      multiple\n      allowAdditions\n      onAddItem={handleAddition}\n      onChange={handleChange}\n    />\n  );\n}\nconst TaskRow = (props: { taskInfo: taskRowRep, tagSet: Array<string>, refreshCallback: any, isCreate: boolean }) => {\n\n  const [open, setOpen] = useState<boolean>(false);\n  const [taskName, setTaskName] = useState<string>(props.taskInfo.name);\n  const [taskDesc, setTaskDesc] = useState<string>(props.taskInfo.desc);\n  const [tags, setTags] = useState<Array<string>>(props.taskInfo.tags);\n  const [taskStatus, setTaskStatus] = useState<string>(props.taskInfo.taskStatus);\n  const handleTagsChange = (tags: Array<string>) => { setTags(tags); }\n\n  const [isError, setIsError] = useState<boolean>(false);\n\n  let trigger_element = (!props.isCreate) ?\n    <Table.Row key={props.taskInfo._id}>\n      <Table.Cell>{props.taskInfo.name}</Table.Cell>\n      <Table.Cell>{props.taskInfo.desc}</Table.Cell>\n      <Table.Cell>\n        <div style={{ display: \"flex\", flexWrap: \"wrap\" }}>\n          {props.taskInfo.tags.map((tag) =>\n            <div style={{ padding: 2 }}>\n              <Label color=\"blue\" tag>{tag}</Label>\n            </div>\n          )}\n        </div>\n      </Table.Cell>\n      <Table.Cell>\n        {\n          (props.taskInfo.taskStatus === 'Not Started') ?\n            <Label color=\"red\">{props.taskInfo.taskStatus}</Label>\n            : (props.taskInfo.taskStatus === 'In Progress') ?\n              <Label color=\"orange\">{props.taskInfo.taskStatus}</Label>\n              :\n              <Label color=\"green\">{props.taskInfo.taskStatus}</Label>\n        }\n      </Table.Cell>\n    </Table.Row>\n    : <Button icon size='huge' labelPosition='left'>\n      <Icon name='plus circle'></Icon>Add\n    </Button>;\n\n  const modalHeader = (props.isCreate) ? \"Add New Task\" : \"Edit Task\";\n  const modalContentHeader = (props.isCreate) ? null : <Header>Editing Task: {props.taskInfo.name}</Header>;\n\n  const modalActions = (props.isCreate) ?\n    <>\n      <Button onClick={() => {\n        setOpen(false);\n        setTaskName(props.taskInfo.name);\n        setTaskDesc(props.taskInfo.desc);\n        setTags(props.taskInfo.tags);\n        setTaskStatus(props.taskInfo.taskStatus);\n      }}>Cancel</Button>\n\n      <Button color='green' onClick={() => {\n        if (taskName === \"\") {\n          setIsError(true);\n          return;\n        }\n\n        setIsError(false);\n        console.log(\"Adding Task\", taskName);\n        fetch(backend_uri + \"createtask\", {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            name: taskName,\n            desc: taskDesc,\n            tags: tags,\n            taskStatus: taskStatus\n          })\n        })\n          .then(res => {\n            if (res.ok) {\n              console.log(\"Task Added\");\n              setOpen(false);\n              props.refreshCallback();\n              // Reset the form\n              setTaskName(props.taskInfo.name);\n              setTaskDesc(props.taskInfo.desc);\n              setTags(props.taskInfo.tags);\n              setTaskStatus(props.taskInfo.taskStatus);\n            }\n            else {\n              console.log(\"Task Addition Failed\");\n            }\n          });\n      }}>\n        <Icon name='checkmark' /> Save\n      </Button>\n    </>\n    :\n    <>\n      <Button.Group floated=\"left\">\n        <Button negative onClick={() => {\n          console.log(\"Deleting Task\", taskName);\n          fetch(backend_uri + \"deletetask\", {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({\n              _id: props.taskInfo._id,\n            })\n          })\n            .then(res => {\n              if (res.ok) {\n                console.log(\"Task Deleted\");\n                setOpen(false);\n                props.refreshCallback();\n              }\n              else {\n                console.log(\"Task Delete Failed\");\n              }\n            });\n        }}>Delete Task</Button>\n      </Button.Group>\n\n      <Button onClick={() => {\n        setOpen(false);\n        setTaskName(props.taskInfo.name);\n        setTaskDesc(props.taskInfo.desc);\n        setTags(props.taskInfo.tags);\n        setTaskStatus(props.taskInfo.taskStatus);\n      }}>Cancel</Button>\n\n      <Button color='green' onClick={() => {\n        if (taskName === \"\") {\n          setIsError(true);\n          return;\n        }\n        setIsError(false);\n        console.log(\"Updating Task\", taskStatus);\n        fetch(backend_uri + \"updatetask\", {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            _id: props.taskInfo._id,\n            name: taskName,\n            desc: taskDesc,\n            tags: tags,\n            taskStatus: taskStatus\n          })\n        })\n          .then(res => {\n            if (res.ok) {\n              console.log(\"Task Updated\");\n              setOpen(false);\n              props.refreshCallback();\n            }\n            else {\n              console.log(\"Task Update Failed\");\n            }\n          });\n      }}>\n        <Icon name='checkmark' /> Save\n      </Button>\n    </>\n  return (\n    <Modal\n      onClose={() => setOpen(false)}\n      onOpen={() => setOpen(true)}\n      open={open}\n      closeOnDimmerClick={false}\n      closeOnEscape={false}\n      trigger={trigger_element}\n    >\n      <Modal.Header>{modalHeader}</Modal.Header>\n      <Modal.Content>\n        <Modal.Description>\n          {modalContentHeader}\n          <Form error={isError}>\n            <Form.Field>\n              <label>Task Name</label>\n              <input placeholder=\"Task Name\" defaultValue={taskName} onChange={(e: any) => setTaskName(e.target.value)} />\n            </Form.Field>\n            <Form.Field>\n              <label>Task Description</label>\n              <TextArea placeholder='Task Description' defaultValue={taskDesc} onChange={(e: any) => setTaskDesc(e.target.value)} />\n            </Form.Field>\n            <Form.Field>\n              <label>Tags</label>\n              <TagDropDown tagSet={props.tagSet} currentTags={tags} onChange={handleTagsChange} />\n            </Form.Field>\n            <Form.Field>\n              <label>Task Status</label>\n              <Dropdown\n                placeholder='Select Status'\n                fluid\n                selection\n                options={statuses}\n                defaultValue={taskStatus}\n                onChange={(e: {}, { value }: any) => { setTaskStatus(value) }}\n              />\n            </Form.Field>\n            <Message\n              error\n              header='Error'\n              content='Ensure the task name is not empty!'\n            />\n          </Form>\n\n        </Modal.Description>\n      </Modal.Content>\n      <Modal.Actions>\n        {modalActions}\n      </Modal.Actions>\n    </Modal>);\n}\nTaskRow.defaultProps = { isCreate: false, taskInfo: { _id: \"\", name: \"\", desc: \"\", tags: [], taskStatus: \"Not Started\" } };\nfunction SearchBox(props: { source: Array<searchBoxRep>, searchInDesc: boolean, updateValue: any }) {\n  const initialState = {\n    loading: false,\n    results: [],\n    value: '',\n  }\n  function SearchBoxReducer(state: any, action: any) {\n    switch (action.type) {\n      case 'CLEAN_QUERY':\n        return initialState\n      case 'START_SEARCH':\n        return { ...state, loading: true, value: action.query }\n      case 'FINISH_SEARCH':\n        return { ...state, loading: false, results: action.results }\n      case 'UPDATE_SELECTION':\n        return { ...state, value: action.selection }\n\n      default:\n        throw new Error()\n    }\n  }\n  const [state, dispatch] = useReducer(SearchBoxReducer, initialState)\n  const { loading, results, value } = state\n\n  // Update results while typing\n  const timeoutRef = React.useRef(0)\n  const handleSearchChange = React.useCallback((e: any, data: any) => {\n    clearTimeout(timeoutRef.current)\n    dispatch({ type: 'START_SEARCH', query: data.value })\n\n    timeoutRef.current = window.setTimeout(() => {\n      if (data.value.length === 0) {\n        dispatch({ type: 'CLEAN_QUERY' })\n        return\n      }\n\n      const re = new RegExp(_.escapeRegExp(data.value), 'i');\n      const isMatch = !props.searchInDesc ? (result: any) => re.test(result.title) : (result: any) => re.test(result.title) || re.test(result.description);\n      dispatch({\n        type: 'FINISH_SEARCH',\n        results: _.filter(props.source, isMatch),\n      })\n    }, 300)\n  }, [props.source, props.searchInDesc])\n  useEffect(() => {\n    dispatch({ type: 'FINISH_SEARCH', results: props.source })\n    return () => {\n      clearTimeout(timeoutRef.current)\n    }\n  }, [props.source])\n\n  useEffect(() => { props.updateValue(value) }, [value, props]);\n\n  return (\n    <Search\n      fluid\n      size='large'\n      loading={loading}\n      placeholder='Search...'\n      onResultSelect={(e, data) => {\n        dispatch({ type: 'UPDATE_SELECTION', selection: data.result.title });\n      }}\n      onSearchChange={handleSearchChange}\n      results={results}\n      value={value}\n    />\n\n  )\n}\n\nconst TaskTable = () => {\n  const [tagSet, setTagSet] = useState<Array<string>>(new Array<string>());\n\n  // Main Table States: Sorting Column, Table Data, Sorting Direction\n  function sortReducer(state: any, action: any) {\n    switch (action.type) {\n      case 'RESET':\n        return initTable(action.payload);\n      case 'CHANGE_SORT':\n        if (state.column === action.column) {\n          return {\n            ...state,\n            data: state.data.slice().reverse(),\n            direction:\n              state.direction === 'ascending' ? 'descending' : 'ascending',\n          }\n        }\n\n        return {\n          column: action.column,\n          data: _.sortBy(state.data, [action.column]),\n          direction: 'ascending',\n        }\n      default:\n        throw new Error()\n    }\n  }\n  const initTable = (newdata: Array<taskRowRep>) => {\n    return { column: null, data: newdata, direction: null };\n  }\n  const [backupData, setBackupData] = useState<Array<taskRowRep>>(new Array<taskRowRep>());\n  const [state, dispatch] = useReducer(sortReducer, [], initTable); // here state = {column, data, dir}\n  const { column, data, direction } = state;\n\n  // Searching States\n  const [searchData, setSearchData] = useState<Array<searchBoxRep>>([]);\n  const [searchTagOptions, setSearchTagOptions] = useState<Array<{ key: string, text: string, value: string }>>([]);\n  const [searchField, setSearchField] = useState<string>(\"\");\n  const [searchInDesc, setSearchInDesc] = useState<boolean>(false);\n  const [searchTags, setSearchTags] = useState<Array<string>>([]);\n  const [searchStatus, setSearchStatus] = useState<string>(\"\");\n\n  // Initial Set-Up, to replace with backend query\n  const initialiseData = () => {\n    /*\n    let initTasks: Array<taskRowRep> = [\n      { _id: \"1\", name: 'Learn HTML', desc: \"Create at least something\", tags: ['Task 1.1', 'Task 1.2', \"Brandon\", \"Hello\", \"hello\"], taskStatus: \"Not Started\" },\n      { _id: \"2\", name: 'Learn CSS', desc: \"Create at least a stylesheet\", tags: ['Task 2.1', 'Task 2.2'], taskStatus: \"In Progress\" },\n      { _id: \"3\", name: 'Learn JAVASCRIPT', desc: \"Create at least an APP\", tags: ['Task 3.1', 'Task 3.2'], taskStatus: \"Completed\" },\n      { _id: \"4\", name: 'Learn C++', desc: \"Create at least a programme\", tags: ['Task 3.1', 'Task 3.2'], taskStatus: \"Completed\" },\n      { _id: \"5\", name: 'Learn Python', desc: \"Create at least an AI\", tags: ['Task 3.1', 'Task 3.2'], taskStatus: \"Completed\" },\n      { _id: \"6\", name: 'Learn Haskell', desc: \"Create at least a paper\", tags: ['Task 3.1', 'Task 3.2'], taskStatus: \"Completed\" },\n      { _id: \"7\", name: 'Learn C#', desc: \"Create at least an game\", tags: ['Task 3.1', 'Task 3.2'], taskStatus: \"Completed\" },\n    ];*/\n\n    const requestOptions = {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n    };\n    fetch(backend_uri + \"getdata\", requestOptions)\n      .then(response => response.json())\n      .then(initTasks => {\n        console.log(\"initTasks: \", initTasks);\n        // Initialise States\n        dispatch({ type: 'RESET', payload: initTasks });\n        setBackupData(initTasks);\n        // Convert to SearchBox format {index, title, description, tags, taskStatus}\n        var initSearchData: Array<searchBoxRep> =\n          initTasks.map((task: taskRowRep) => { return { _id: task._id, title: task.name, description: task.desc, tags: task.tags, taskStatus: task.taskStatus } });\n        setSearchData(initSearchData);\n\n        let initTagSet = new Array<string>();\n        initTasks.forEach((task: taskRowRep) => {\n          task.tags.forEach(tag => {\n            initTagSet.push(tag);\n          });\n        });\n        initTagSet = Array.from(new Set(initTagSet)); // Remove duplicates\n        initTagSet.sort((a, b) => {                   // Sort alphabetically\n          return (a.toLowerCase() > b.toLowerCase()) ? 1 : -1;\n        });\n\n        // Convert to Search Tag Dropdown Format {key, text, value}\n        var initsearchTagOptions = new Array<{ key: string, text: string, value: string }>();\n        initTagSet.forEach(tag => {\n          initsearchTagOptions.push({ key: tag, text: tag, value: tag });\n        });\n\n        setSearchTagOptions(initsearchTagOptions);\n        setTagSet(initTagSet);\n      })\n      .catch(error => console.log('Error Getting Data from Server: ', error));\n  }\n\n  useEffect(initialiseData, []);\n\n  // ===== Handle Searching =====\n  // Update Filters\n\n  useEffect(() => {\n    let newSearchOptions: Array<searchBoxRep> =\n      backupData.map((task: taskRowRep) => { return { _id: task._id, title: task.name, description: task.desc, tags: task.tags, taskStatus: task.taskStatus } });\n\n    if (searchTags.length > 0) {\n      newSearchOptions = newSearchOptions.filter(task => {\n        return searchTags.every(tag => {\n          return task.tags.includes(tag);\n        });\n      });\n    }\n\n    if (searchStatus !== \"\") {\n      newSearchOptions = newSearchOptions.filter(task => {\n        return task.taskStatus === searchStatus;\n      });\n    }\n    setSearchData(newSearchOptions);\n  }, [searchTags, searchStatus, backupData]);\n\n  const handleSubmit = () => {\n    let newData = backupData;\n    if (searchField !== \"\") {\n      newData = newData.filter(task => {\n        if (searchInDesc) {\n          return (task.desc.toLowerCase().includes(searchField.toLowerCase()) || task.name.toLowerCase().includes(searchField.toLowerCase()));\n        } else {\n          return task.name.toLowerCase().includes(searchField.toLowerCase());\n        }\n      });\n    }\n    if (searchTags.length > 0) {\n      newData = newData.filter(task => {\n        return searchTags.every(tag => {\n          return task.tags.includes(tag);\n        });\n      });\n    }\n\n    if (searchStatus !== \"\") {\n      newData = newData.filter(task => {\n        return task.taskStatus === searchStatus;\n      });\n    }\n\n    dispatch({ type: 'RESET', payload: newData });\n  }\n\n\n  return (\n    <div>\n      <Grid stackable>\n        <Grid.Row stretched >\n          <Grid.Column width={14}>\n            <Segment>\n              <Form onSubmit={handleSubmit}>\n                <Form.Group inline>\n\n                  <label>Search</label>\n                  <div style={{ width: \"40em\" }}>\n                    <SearchBox\n                      key={JSON.stringify(searchData) + searchInDesc}\n                      source={searchData}\n                      searchInDesc={searchInDesc}\n                      updateValue={setSearchField} />\n                  </div>\n\n                  <div>&nbsp;&nbsp;</div>\n                  <div style={{ display: \"flex\", alignItems: \"center\" }}>\n                    <Form.Field  >\n                      <Checkbox label='Search in Descriptions' onChange={(e: any, d: any) => { setSearchInDesc(d.checked); }} />\n                    </Form.Field>\n                  </div>\n\n                  <label>Filters</label>\n                  <Dropdown\n                    placeholder='Select Tags'\n                    fluid\n                    multiple\n                    search\n                    selection\n                    onChange={(e: {}, { value }: any) => { setSearchTags(value); }}\n                    options={searchTagOptions}\n                  />\n                  <div>&nbsp;&nbsp;</div>\n                  <Dropdown\n                    placeholder='Select Status'\n                    clearable\n                    selection\n                    options={statuses}\n                    onChange={(e: {}, { value }: any) => { setSearchStatus(value); }}\n                  />\n                  <div>&nbsp;&nbsp;</div>\n                  <Form.Button content='Submit' />\n                </Form.Group>\n              </Form>\n            </Segment>\n          </Grid.Column>\n          <Grid.Column width={2} >\n            <Segment style={{ display: \"flex\", justifyContent: \"center\", alignItems: \"center\" }}>\n              &nbsp;&nbsp;\n              <TaskRow tagSet={tagSet} refreshCallback={initialiseData} isCreate={true} />\n            </Segment>\n          </Grid.Column>\n        </Grid.Row>\n      </Grid>\n      <Table celled selectable sortable>\n        <Table.Header>\n          <Table.Row>\n            <Table.HeaderCell\n              sorted={column === 'name' ? direction : null}\n              onClick={() => {\n                dispatch({ type: 'CHANGE_SORT', column: 'name' });\n              }}\n              key=\"name\"\n              width={3}\n            >Task Name</Table.HeaderCell>\n            <Table.HeaderCell\n              sorted={column === 'desc' ? direction : null}\n              onClick={() => dispatch({ type: 'CHANGE_SORT', column: 'desc' })}\n              key=\"desc\"\n              width={7}\n            >Task Description</Table.HeaderCell>\n            <Table.HeaderCell\n              sorted={column === 'tags' ? direction : null}\n              onClick={() => dispatch({ type: 'CHANGE_SORT', column: 'tags' })}\n              key=\"tags\"\n              width={4}\n            >Tags</Table.HeaderCell>\n            <Table.HeaderCell\n              sorted={column === 'taskStatus' ? direction : null}\n              onClick={() => dispatch({ type: 'CHANGE_SORT', column: 'taskStatus' })}\n              key=\"taskStatus\"\n              width={2}\n            >Completed</Table.HeaderCell>\n          </Table.Row>\n        </Table.Header>\n\n        <Table.Body>\n          {data.map((rowData: taskRowRep) =>\n            <TaskRow key={rowData._id} taskInfo={rowData} tagSet={tagSet} refreshCallback={initialiseData}></TaskRow>\n          )}\n        </Table.Body>\n      </Table>\n    </div>\n\n  );\n}\n\nconst MainBodySegment = () => {\n  return (\n    <div className=\"mainBodySegment\">\n      <Segment>\n        <div style={{ textAlign: 'center' }}>\n          <h1>Brandon's \"Modern\" To-Do App</h1>\n        </div>\n        <Divider></Divider>\n        <TaskTable />\n      </Segment >\n    </div >\n  );\n}\n\nfunction App() {\n  useEffect(() => {\n    document.title = \"Modern TODO App\";\n  });\n\n  return (\n    <div\n      style={{\n        padding: '3em',\n      }} >\n      <Helmet>\n        <style>{\"body { background-color: #eddefa; }\"}</style>\n      </Helmet>\n\n      <MainBodySegment />\n    </div >\n  );\n}\n\nexport default App;"],"mappings":"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"},"metadata":{},"sourceType":"module"}